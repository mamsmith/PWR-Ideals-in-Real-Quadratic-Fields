Algorithm 3:
Input: k,l odd such that gcd(k,l)=2, 8|kl, and k<l<sqrt(3)k


SageMath:

def A3(k,l):
	(a,b,c)=xgcd(k^2,l^2)
	c1=abs(c)
	b1=abs(b)
	n=0
	if 2.divides(c1)==False and 2.divides(b1)==False:
		if c1.mod(4)==b1.mod(4):
			d1=b1
			d2=c1
		if c1.mod(4)!=b1.mod(4):
			d1=b1 + k^2/2
			d2=c1 + l^2/2
	if 2.divides(c1)==True:
		if b1.mod(4)==(c1+1).mod(4):
			d1= k^2/4 + b1
			d2=l^2/4+c1
		if b1.mod(4)==(c1+3).mod(4):
			d1= 3*k^2/4 + b1
			d2=3*l^2/4 + c1
	if 2.divides(b1)==True:
		if c1.mod(4)==(b1+1).mod(4):
			d1= k^2/4 + b1
			d2=l^2/4 + c1
		if c1.mod(4)==(b1+3).mod(4):
			d1= 3*k^2/4 + b1
			d2=3*l^2/4 + c1
	while d1.is_squarefree()==False or d2.is_squarefree()==False:
		d1=d1+n*k^2
		d2=d2+n*l^2
		n=n+1
	return(d1,d2)
